{"remainingRequest":"/home/khalil/Projects/PFE/scrapy_app/vuejs_frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/khalil/Projects/PFE/scrapy_app/vuejs_frontend/src/components/ProductsData.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/khalil/Projects/PFE/scrapy_app/vuejs_frontend/src/components/ProductsData.vue","mtime":1632089283993},{"path":"/home/khalil/Projects/PFE/scrapy_app/vuejs_frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/khalil/Projects/PFE/scrapy_app/vuejs_frontend/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/khalil/Projects/PFE/scrapy_app/vuejs_frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/khalil/Projects/PFE/scrapy_app/vuejs_frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7bWFwQWN0aW9ucyxtYXBHZXR0ZXJzfSBmcm9tICJ2dWV4IgoKICBleHBvcnQgZGVmYXVsdCB7CiAgICBuYW1lOiAnQ3JlYXRlQ3Jhd2xlcicsCgogICAgZGF0YSgpCiAgICB7CiAgICAgIHJldHVybnsKICAgICAgICBwcm9kdWN0c0tleXM6IFtdLAogICAgICAgIGhlYWRlcnM6IFtdLAogICAgICAgIGRyb3BQcm9kdWN0c0RhdGFBbGVydDogZmFsc2UsCiAgICAgICAgZHJvcFByb2R1Y3RzRGF0YVRpbWVvdXRNZXNzYWdlOiA1MDAwLAogICAgICAgIGRyb3BQcm9kdWN0c0RhdGFBbGVydEljb246ICcnLAogICAgICAgIGRyb3BQcm9kdWN0c0RhdGFBbGVydE1lc3NhZ2U6ICcnLAoKICAgICAgfQogICAgfSwKCiAgICB3YXRjaDogewogICAgICBnZXRGdWxsUGF0aCgpewogICAgICAgIHRoaXMucmVuZGVyUHJvZHVjdHNEYXRhVGFibGUoKQogICAgICAgIGNvbnNvbGUubG9nKHRoaXMuaGVhZGVycykKICAgICAgfQogICAgfSwKCiAgICBtb3VudGVkKCl7CiAgICAgIAogICAgfSwKCiAgICBjb21wdXRlZDogewogICAgICAuLi5tYXBHZXR0ZXJzKCJDcmF3bGVyIixbImdldFByb2R1Y3RzRGF0YUZyb21EQiJdKSwKICAgICAgLi4ubWFwR2V0dGVycygiQ3Jhd2xlciIsWyJnZXRMb2FkaW5nUHJvZHVjdHNEYXRhIl0pLAogICAgICAuLi5tYXBHZXR0ZXJzKCJDcmF3bGVyIixbImdldExvYWRpbmdQcm9kdWN0c0Ryb3AiXSksCiAgICAgIC4uLm1hcEdldHRlcnMoIkNyYXdsZXIiLFsiZ2V0Sm9iU3RhdGUiXSksCgogICAgICBnZXRGdWxsUGF0aCAoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuJHJvdXRlLnBhdGgKICAgICAgfSwKICAgIH0sCgogICAgbWV0aG9kczp7CiAgICAgICAgLi4ubWFwQWN0aW9ucygnQ3Jhd2xlcicsWydnZXRQcm9kdWN0c0RhdGEnXSksCiAgICAgICAgLi4ubWFwQWN0aW9ucygnQ3Jhd2xlcicsWydkcm9wUHJvZHVjdHNEYXRhJ10pLAoKICAgICAgICByZW1vdmVEdXBsaWNhdGVzKGFycmF5KSB7CiAgICAgICAgICByZXR1cm4gYXJyYXkuZmlsdGVyKChhLCBiKSA9PiBhcnJheS5pbmRleE9mKGEpID09PSBiKQogICAgICAgIH0sCgogICAgICAgIGdldFByb2R1Y3RzRGF0YUVsZW1lbnRzS2V5cygpewogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgbGV0IF9wcm9kdWN0a2V5cyA9IFtdCiAgICAgICAgICAgIHRoaXMuZ2V0UHJvZHVjdHNEYXRhRnJvbURCLmZvckVhY2gocHJvZHVjdCA9PiB7CiAgICAgICAgICAgICAgX3Byb2R1Y3RrZXlzLnB1c2goT2JqZWN0LmtleXMocHJvZHVjdCkpCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBsZXQgbWVyZ2VQcm9kdWN0c0tleXMgPSBbXS5jb25jYXQuYXBwbHkoW10sIF9wcm9kdWN0a2V5cyk7CiAgICAgICAgICAgIHRoaXMucHJvZHVjdHNLZXlzID0gdGhpcy5yZW1vdmVEdXBsaWNhdGVzKG1lcmdlUHJvZHVjdHNLZXlzKQogICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgICAgY29uc29sZS5lcnJvcignTm8gUHJvZHVjdHMgZGF0YScpCiAgICAgICAgICB9CiAgICAgICAgICAKICAgICAgICB9LAoKICAgICAgICBnZW5lcmF0ZUhlYWRlcnMoKXsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIHRoaXMucHJvZHVjdHNLZXlzLmZvckVhY2goa2V5ID0+IHsKICAgICAgICAgICAgICBsZXQgaGVhZGVyID0ge30KICAgICAgICAgICAgICBoZWFkZXJbJ3RleHQnXSA9IGtleTsKICAgICAgICAgICAgICBoZWFkZXJbJ3ZhbHVlJ10gPSBrZXk7CiAgICAgICAgICAgICAgaGVhZGVyWydhbGlnbiddID0gJ2xlZnQnCiAgICAgICAgICAgICAgdGhpcy5oZWFkZXJzLnB1c2goaGVhZGVyKQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ05vIFByb2R1Y3RzIGRhdGEnKQogICAgICAgICAgfQogICAgICAgICAgCiAgICAgICAgfSwKCiAgICAgICAgcmVuZGVyUHJvZHVjdHNEYXRhVGFibGUoKXsKICAgICAgICAgIHRoaXMuZ2V0UHJvZHVjdHNEYXRhKCkgIAogICAgICAgICAgdGhpcy5nZXRQcm9kdWN0c0RhdGFFbGVtZW50c0tleXMoKQogICAgICAgICAgdGhpcy5nZW5lcmF0ZUhlYWRlcnMoKQogICAgICAgIH0sCgogICAgICAgIHJlZnJlc2hEYXRhVGFibGUoKXsKICAgICAgICAgIGxvY2F0aW9uLnJlbG9hZCgpOwogICAgICAgIH0sCgogICAgICAgIGRyb3BQcm9kdWN0cygpewogICAgICAgICAgbGV0IHZtID0gdGhpcwogICAgICAgICAgdGhpcy5kcm9wUHJvZHVjdHNEYXRhKHZtKQogICAgICAgIH0sCgogICAgICAgIGRvd25sb2FkQ1NWRmlsZSgpewogICAgICAgICAgbGV0IHByb2R1Y3RzSlNPTiA9IEpTT04uc3RyaW5naWZ5KHRoaXMuZ2V0UHJvZHVjdHNEYXRhRnJvbURCKTsKICAgICAgICAgIGxldCBjc3YgPSB0aGlzLkNvbnZlcnRUb0NTVihwcm9kdWN0c0pTT04pCiAgICAgICAgICBsZXQgZmlsZW5hbWUgPSAncHJvZHVjdHNfZGF0YV8nK3RoaXMuZ2V0UHJvZHVjdHNEYXRhRnJvbURCLmxlbmd0aCsnLmNzdicKICAgICAgICAgIGNvbnN0IGFuY2hvciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsKICAgICAgICAgIGFuY2hvci5ocmVmID0gJ2RhdGE6dGV4dC9jc3Y7Y2hhcnNldD11dGYtOCwnICsgZW5jb2RlVVJJQ29tcG9uZW50KGNzdik7CiAgICAgICAgICBhbmNob3IudGFyZ2V0ID0gJ19ibGFuayc7CiAgICAgICAgICBhbmNob3IuZG93bmxvYWQgPSBmaWxlbmFtZTsKICAgICAgICAgIGFuY2hvci5jbGljaygpOwogICAgICAgIH0sCgogICAgICAgIGRvd25sb2FkSlNPTkZpbGUoKXsKICAgICAgICAgIGxldCBwcm9kdWN0c0pTT04gPSBKU09OLnN0cmluZ2lmeSh0aGlzLmdldFByb2R1Y3RzRGF0YUZyb21EQik7CiAgICAgICAgICBsZXQgZmlsZW5hbWUgPSAncHJvZHVjdHNfZGF0YV8nK3RoaXMuZ2V0UHJvZHVjdHNEYXRhRnJvbURCLmxlbmd0aCsnLmpzb24nCiAgICAgICAgICBjb25zdCBhbmNob3IgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7CiAgICAgICAgICBhbmNob3IuaHJlZiA9ICdkYXRhOnRleHQvY3N2O2NoYXJzZXQ9dXRmLTgsJyArIGVuY29kZVVSSUNvbXBvbmVudChjc3YpOwogICAgICAgICAgYW5jaG9yLnRhcmdldCA9ICdfYmxhbmsnOwogICAgICAgICAgYW5jaG9yLmRvd25sb2FkID0gZmlsZW5hbWU7CiAgICAgICAgICBhbmNob3IuY2xpY2soKTsKICAgICAgICB9LAoKICAgICAgICBDb252ZXJ0VG9DU1Yob2JqQXJyYXkpIHsKICAgICAgICAgICAgdmFyIGFycmF5ID0gdHlwZW9mIG9iakFycmF5ICE9ICdvYmplY3QnID8gSlNPTi5wYXJzZShvYmpBcnJheSkgOiBvYmpBcnJheTsKICAgICAgICAgICAgdmFyIGNzdiA9ICcnOwogICAgICAgICAgICBhcnJheS5mb3JFYWNoKHByb2R1Y3QgPT4gewogICAgICAgICAgICAgIHZhciBhcnJfbGluZSA9IFtdCiAgICAgICAgICAgICAgdGhpcy5wcm9kdWN0c0tleXMuZm9yRWFjaChlbGVtZW50ID0+IHsKICAgICAgICAgICAgICAgIHZhciBwcl9rZXlzID0gT2JqZWN0LmtleXMocHJvZHVjdCkKICAgICAgICAgICAgICAgIGlmKHByX2tleXMuaW5jbHVkZXMoZWxlbWVudCkpewogICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IHByb2R1Y3RbZWxlbWVudF0KICAgICAgICAgICAgICAgICAgZGF0YSA9IGRhdGEgIT0gbnVsbCA/IGRhdGEudG9TdHJpbmcoKSA6ICcnCiAgICAgICAgICAgICAgICAgIGlmKGVsZW1lbnQgIT0gJ3VybCcgJiYgZWxlbWVudCAhPSAnbGFzdF91cGRhdGVfZGF0ZScpCiAgICAgICAgICAgICAgICAgICAgZGF0YSA9IGRhdGEucmVwbGFjZSgvW1wvXFwnIjoqPzw+e31dL2csJycpCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBkYXRhLmluY2x1ZGVzKCcsJykgPyAnIicrZGF0YSsnIicgOiBkYXRhCiAgICAgICAgICAgICAgICAgIGFycl9saW5lLnB1c2goZGF0YSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgYXJyX2xpbmUucHVzaCgnJykKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICBjc3YgKz0gYXJyX2xpbmUuam9pbignLCcpKyAnXHJcbicKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBjc3YgPSB0aGlzLnByb2R1Y3RzS2V5cy5qb2luKCcsJykrJ1xyXG4nK2NzdgogICAgICAgICAgICAKICAgICAgICAgICAgcmV0dXJuIGNzdjsKICAgICAgICB9CiAgICAgICAgCiAgICB9LAoKICAgIGNyZWF0ZWQoKSB7CiAgICAgIHRoaXMucmVuZGVyUHJvZHVjdHNEYXRhVGFibGUoKQogICAgfQogIH0K"},{"version":3,"sources":["ProductsData.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsHA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA","file":"ProductsData.vue","sourceRoot":"src/components","sourcesContent":["<template>\n   <v-app id=\"inspire\">\n      <v-main>\n        <v-btn color=\"error\" \n              style=\"margin-right: 10px;margin-bottom:10px\" \n              @click=\"dropProducts\"\n              :disabled=\"getJobState != 'finished' || getProductsDataFromDB.length == 0  ? true : false\"\n              >\n          <v-icon left>mdi-database-remove</v-icon>\n              CLEAR PRODUCTS DATA\n        </v-btn>\n        <!-- <v-btn\n              color=\"success\"\n              style=\"margin-right: 10px;margin-bottom:10px\" \n              @click=\"downloadCSVFile\"\n              >\n          <v-icon left>mdi-file-download-outline</v-icon>\n              Download CSV file\n        </v-btn> -->\n        <v-menu\n          rounded=\"lg\"\n          offset-y\n        >\n          <template v-slot:activator=\"{ attrs, on }\">\n            <v-btn\n              color=\"success\"\n              style=\"margin-right: 10px;margin-bottom:10px\"\n              class=\"white--text\"\n              v-bind=\"attrs\"\n              v-on=\"on\"\n            >\n              <v-icon left>mdi-download</v-icon>\n              Download Products Data\n              <v-icon right>mdi-chevron-down</v-icon>\n            </v-btn>\n          </template>\n\n          <v-list>\n            <v-list-item\n              link\n            >\n              <v-list-item-title @click=\"downloadCSVFile\">\n                <v-icon left>mdi-file-delimited</v-icon>\n                Download CSV\n              </v-list-item-title>\n            </v-list-item>\n          </v-list>\n          <v-list>\n            <v-list-item\n              link\n            >\n              <v-list-item-title>\n                <v-icon left>mdi-code-json</v-icon>\n                Download JSON\n              </v-list-item-title>\n            </v-list-item>\n          </v-list>\n        </v-menu>\n        <v-btn \n              style=\"margin-right: 10px;margin-bottom:10px\" \n              @click=\"refreshDataTable\"\n              >\n          <v-icon left>mdi-database-refresh</v-icon>\n              Refresh\n        </v-btn>\n        <v-card>\n          <v-card-title v-if=\"getProductsDataFromDB.length > 0\">\n            Products Data ({{getProductsDataFromDB.length}} products)\n            <v-spacer></v-spacer>\n            </v-card-title>\n          <v-card-title v-else>\n            No products data found\n            <v-spacer></v-spacer>\n            </v-card-title>\n          <v-data-table v-show=\"getProductsDataFromDB.length > 0\"\n            :headers=\"headers\"\n            :items=\"getProductsDataFromDB\"\n            class=\"elevation-1\"\n            :loading=\"getLoadingProductsData\"\n            loading-text=\"Loading... Please wait, this might take sometime\"\n          >\n            <template v-slot:item.url=\"{ item }\">\n              <a :href=\"item.url\" target=\"_blank\">{{item.url}}</a>\n            </template>\n          </v-data-table>\n        </v-card>\n        <v-snackbar\n          ref=\"dropProductsData\"\n          elevation=\"24\"\n          color=\"success\"\n          v-model=\"dropProductsDataAlert\"\n          :timeout=\"dropProductsDataTimeoutMessage\"\n        >\n            <v-icon large>{{dropProductsDataAlertIcon}}</v-icon>\n            <b style=\"font-size:150%; margin-left:5px\">{{ dropProductsDataAlertMessage }}</b>\n            <template v-slot:action=\"{ attrs }\">\n              <v-btn\n                color=\"white\"\n                text\n                v-bind=\"attrs\"\n                @click=\"dropProductsDataAlert = false\"\n              >\n                Close\n              </v-btn>\n            </template>\n        </v-snackbar>\n        <v-overlay :value=\"getLoadingProductsDrop\">\n          <v-progress-circular\n            indeterminate\n            size=\"64\"\n          ></v-progress-circular>\n        </v-overlay>\n      </v-main>\n   </v-app>\n</template>\n\n\n<script>\nimport {mapActions,mapGetters} from \"vuex\"\n\n  export default {\n    name: 'CreateCrawler',\n\n    data()\n    {\n      return{\n        productsKeys: [],\n        headers: [],\n        dropProductsDataAlert: false,\n        dropProductsDataTimeoutMessage: 5000,\n        dropProductsDataAlertIcon: '',\n        dropProductsDataAlertMessage: '',\n\n      }\n    },\n\n    watch: {\n      getFullPath(){\n        this.renderProductsDataTable()\n        console.log(this.headers)\n      }\n    },\n\n    mounted(){\n      \n    },\n\n    computed: {\n      ...mapGetters(\"Crawler\",[\"getProductsDataFromDB\"]),\n      ...mapGetters(\"Crawler\",[\"getLoadingProductsData\"]),\n      ...mapGetters(\"Crawler\",[\"getLoadingProductsDrop\"]),\n      ...mapGetters(\"Crawler\",[\"getJobState\"]),\n\n      getFullPath () {\n        return this.$route.path\n      },\n    },\n\n    methods:{\n        ...mapActions('Crawler',['getProductsData']),\n        ...mapActions('Crawler',['dropProductsData']),\n\n        removeDuplicates(array) {\n          return array.filter((a, b) => array.indexOf(a) === b)\n        },\n\n        getProductsDataElementsKeys(){\n          try {\n            let _productkeys = []\n            this.getProductsDataFromDB.forEach(product => {\n              _productkeys.push(Object.keys(product))\n            });\n            let mergeProductsKeys = [].concat.apply([], _productkeys);\n            this.productsKeys = this.removeDuplicates(mergeProductsKeys)\n          } catch (error) {\n            console.error('No Products data')\n          }\n          \n        },\n\n        generateHeaders(){\n          try {\n            this.productsKeys.forEach(key => {\n              let header = {}\n              header['text'] = key;\n              header['value'] = key;\n              header['align'] = 'left'\n              this.headers.push(header)\n            });\n          } catch (error) {\n            console.error('No Products data')\n          }\n          \n        },\n\n        renderProductsDataTable(){\n          this.getProductsData()  \n          this.getProductsDataElementsKeys()\n          this.generateHeaders()\n        },\n\n        refreshDataTable(){\n          location.reload();\n        },\n\n        dropProducts(){\n          let vm = this\n          this.dropProductsData(vm)\n        },\n\n        downloadCSVFile(){\n          let productsJSON = JSON.stringify(this.getProductsDataFromDB);\n          let csv = this.ConvertToCSV(productsJSON)\n          let filename = 'products_data_'+this.getProductsDataFromDB.length+'.csv'\n          const anchor = document.createElement('a');\n          anchor.href = 'data:text/csv;charset=utf-8,' + encodeURIComponent(csv);\n          anchor.target = '_blank';\n          anchor.download = filename;\n          anchor.click();\n        },\n\n        downloadJSONFile(){\n          let productsJSON = JSON.stringify(this.getProductsDataFromDB);\n          let filename = 'products_data_'+this.getProductsDataFromDB.length+'.json'\n          const anchor = document.createElement('a');\n          anchor.href = 'data:text/csv;charset=utf-8,' + encodeURIComponent(csv);\n          anchor.target = '_blank';\n          anchor.download = filename;\n          anchor.click();\n        },\n\n        ConvertToCSV(objArray) {\n            var array = typeof objArray != 'object' ? JSON.parse(objArray) : objArray;\n            var csv = '';\n            array.forEach(product => {\n              var arr_line = []\n              this.productsKeys.forEach(element => {\n                var pr_keys = Object.keys(product)\n                if(pr_keys.includes(element)){\n                  var data = product[element]\n                  data = data != null ? data.toString() : ''\n                  if(element != 'url' && element != 'last_update_date')\n                    data = data.replace(/[\\/\\\\'\":*?<>{}]/g,'')\n                  data = data.includes(',') ? '\"'+data+'\"' : data\n                  arr_line.push(data)\n                }\n                else\n                  arr_line.push('')\n              });\n              csv += arr_line.join(',')+ '\\r\\n'\n            });\n\n            csv = this.productsKeys.join(',')+'\\r\\n'+csv\n            \n            return csv;\n        }\n        \n    },\n\n    created() {\n      this.renderProductsDataTable()\n    }\n  }\n</script>\n"]}]}